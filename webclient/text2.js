var WEB=!0;(function(){var b,l,e,g,m,t,a,d,o;e=window.sharejs,b=function(e){var t,r,n,o;if(!Array.isArray(e))throw new Error("Op must be an array of components");for(r=null,n=0,o=e.length;n<o;n++){switch(typeof(t=e[n])){case"object":if(!("number"==typeof t.d&&0<t.d))throw new Error("Object components must be deletes of size > 0");break;case"string":if(!(0<t.length))throw new Error("Inserts cannot be empty");break;case"number":if(!(0<t))throw new Error("Skip components must be >0");if("number"==typeof r)throw new Error("Adjacent skip components should be combined")}r=t}if("number"==typeof r)throw new Error("Op has a trailing skip")},g=function(t){return function(e){if(e&&0!==e.d)return 0===t.length?t.push(e):typeof e==typeof t[t.length-1]?"object"==typeof e?t[t.length-1].d+=e.d:t[t.length-1]+=e:t.push(e)}},m=function(o){var s,i;return i=s=0,[function(e,t){var r,n;return s===o.length?-1===e?null:e:"number"==typeof(r=o[s])?-1===e||r-i<=e?(n=r-i,++s,i=0,n):(i+=e,e):"string"==typeof r?(-1===e||"i"===t||r.length-i<=e?(n=r.slice(i),++s,i=0):(n=r.slice(i,i+e),i+=e),n):-1===e||"d"===t||r.d-i<=e?(n={d:r.d-i},++s,i=0,n):(i+=e,{d:e})},function(){return o[s]}]},l=function(e){return"number"==typeof e?e:e.length||e.d},d=function(e){return 0<e.length&&"number"==typeof e[e.length-1]&&e.pop(),e},(t={name:"text2",create:function(){return""}}).normalize=function(e){var t,r,n,o;for(t=g(r=[]),n=0,o=e.length;n<o;n++)t(e[n]);return d(r)},t.apply=function(e,t){var r,n,o,s;if("string"!=typeof e)throw new Error("Snapshot should be a string");for(b(t),n=[],o=0,s=t.length;o<s;o++)switch(typeof(r=t[o])){case"number":if(r>e.length)throw new Error("The op is too long for this document");n.push(e.slice(0,r)),e=e.slice(r);break;case"string":n.push(r);break;case"object":e=e.slice(r.d)}return n.join("")+e},t.transform=function(e,t,r){var n,o,s,i,a,c,f,u,h,p;if("left"!==r&&"right"!==r)throw new Error("side ("+r+") must be 'left' or 'right'");for(b(e),b(t),n=g(a=[]),f=(p=m(e))[0],c=p[1],u=0,h=t.length;u<h;u++)switch(typeof(s=t[u])){case"number":for(i=s;0<i;)n(o=f(i,"i")),"string"!=typeof o&&(i-=l(o));break;case"string":"left"===r&&"string"==typeof c()&&n(f(-1)),n(s.length);break;case"object":for(i=s.d;0<i;)switch(typeof(o=f(i,"i"))){case"number":i-=o;break;case"string":n(o);break;case"object":i-=o.d}}for(;s=f(-1);)n(s);return d(a)},t.compose=function(e,t){var r,n,o,s,i,a,c,f,u;for(b(e),b(t),r=g(i=[]),a=(u=m(e))[0],u[1],c=0,f=t.length;c<f;c++)switch(typeof(o=t[c])){case"number":for(s=o;0<s;)r(n=a(s,"d")),"object"!=typeof n&&(s-=l(n));break;case"string":r(o);break;case"object":for(s=o.d;0<s;)switch(typeof(n=a(s,"d"))){case"number":r({d:n}),s-=n;break;case"string":s-=n.length;break;case"object":r(n)}}for(;o=a(-1);)r(o);return d(i)},a=function(e,t){var r,n,o,s;for(o=n=0,s=t.length;o<s&&(r=t[o],!(e<=n));o++)switch(typeof r){case"number":if(e<=n+r)return e;n+=r;break;case"string":n+=r.length,e+=r.length;break;case"object":e-=Math.min(r.d,e-n)}return e},t.transformCursor=function(e,t,r){var n,o,s,i;if(o=0,r){for(s=0,i=t.length;s<i;s++)switch(typeof(n=t[s])){case"number":o+=n;break;case"string":o+=n.length}return[o,o]}return[a(e[0],t),a(e[1],t)]},e.types.text2=t,(o=e.types.text2).api={provides:{text:!0},getLength:function(){return this.snapshot.length},getText:function(){return this.snapshot},insert:function(e,t,r){var n;return n=o.normalize([e,t]),this.submitOp(n,r),n},del:function(e,t,r){var n;return n=o.normalize([e,{d:t}]),this.submitOp(n,r),n},_register:function(){return this.on("remoteop",function(e,t){var r,n,o,s,i,a;for(n=o=0,a=[],s=0,i=e.length;s<i;s++)switch(typeof(r=e[s])){case"number":n+=r,a.push(o+=r);break;case"string":this.emit("insert",n,r),a.push(n+=r.length);break;case"object":this.emit("delete",n,t.slice(o,o+r.d)),a.push(o+=r.d);break;default:a.push(void 0)}return a})}}}).call(this);